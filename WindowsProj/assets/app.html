<html>
  <head>
    <title>ModbusC++</title>
    <style>
    body {
      font-family: -apple-system, 'Segoe UI Light', Ubuntu, Arial, sans-serif;
    }
    </style>
	<link rel="stylesheet" href="mainPageStyles.css">
	<script src="mainPageScripts.js"></script>
	
  </head>
  <body onload="LoadPorts();load()">
    <div id="result">Test</div>
	<div id="error-container">E</div>
    <script>
      // Define a function to handle JavaScript errors
      function handleErrors(msg, url, line, col, error) {
        // Create an error message string
        var errMsg = "Error: " + msg + "<br>" +
                     "URL: " + url + "<br>" +
                     "Line: " + line + "<br>" +
                     "Column: " + col + "<br>" +
                     "Stack Trace: " + error.stack;
                     
        // Display the error message in the error container
        var errorContainer = document.getElementById("error-container");
        errorContainer.innerHTML = errMsg;
        
        // Prevent the default error handling behavior
        return true;
      }
      
      // Attach the error handling function to the window.onerror event
      window.onerror = handleErrors;
      
      // Throw an error for testing purposes
      
    </script>
    <div class="parent-container">
      <div class="toolbar">
        <button onclick="Connect();">Connect</button>
        <button onclick="LoadPorts();refreshPorts();">Refresh Ports</button>

      </div>
      <div>
        <div class="column">
          <div class="contain">
        <form id="modbus-form">
            <p class="section-header">Settings</p>
            <div class="settingsContainer">
              <div class="custom-select">
                <label for="serialPort">Serial Port</label>

                <select id="serialPort" name="serialPort" class="settingsLists"></select>
              </div>
              

              <div class="custom-select">
                <label for="baudRate">Baud Rate</label>
                
                <select id="baudRate" name="baudRate" class="settingsLists">
                  <option value="1200">1200</option>
                  <option value="2400">2400</option>
                  <option value="4800">4800</option>
                  <option value="9600">9600</option>
                  <option value="19200">19200</option>
                  <option value="38400">38400</option>
                  <option value="57600">57600</option>
                  <option value="115200">115200</option>
                </select>
              </div>
              <div class="custom-select">
                <label for="dataBits">Data Bits</label>

                <select id="dataBits" name="dataBits" class="settingsLists">
                  <option value="7">7</option>
                  <option value="8">8</option>
                </select>
              </div>
              <div class="custom-select">
                <label for="stopBits">Stop Bits</label>

                <select id="stopBits" name="stopBits" class="settingsLists">
                  <option value="0">0</option>
                  <option value="1">1</option>
                </select>
              </div>
              <div class="custom-select">
                <label for="parity">Parity</label>

                <select id="parity" name="parity" class="settingsLists">
                  <option value="N">None</option>
                  <option value="E">Even</option>
                  <option value="O">Odd</option>
                </select>
              </div>
            </div>
          </div>

          <div id="registerRead" class="contain">
            <p class="section-header">Modbus Request</p>

            <div class="settingsContainer">
              <div class="settings">
                <label for="slaveId">Slave ID</label>
                
                <input type="number" id="slaveId" name="slaveId"></input>
              </div>
              <div class="custom-select">
                <label for="functionCode">Function Code</label>
                
                <select id="functionCode" name="functionCode">
                        <option value="01">Read Coils (0x01)</option>
                        <option value="03">Read Multiple Holding Registers (0x03)</option>
                        <option value="04">Read Input Registers (0x04)</option>
                        <option value="10">Write Multiple Holding Registers (0x10)</option>
                        <option value="15">Write Multiple Coils (0x0F)</option>
                </select>
              </div>
              <div class="settings">
                <label for="startAddr">Start address</label>
                
                <input type="number" id="startAddr" name="startAddr"></input>
              </div>
              <div class="settings">
                <label for="numCoils">Num. coils</label>
                
                <input type="number" id="numCoils" name="numCoils"></input>
              </div>
            </div>
            <div style="display: flex; flex-direction: row-reverse; align-items: center;">
                <p style="font-size: 60%">Display Hex Data</p>
                <input type="checkbox" name="hex-data-checkbox" value="display-hex-data" checked="checked"
                    style="padding-top: 3px;"></input>
            </div>

            <div class="settingsContainer">
    
                    <input type="text" disabled="true" id="hex-data" style="width: max-width"></input>
                    <div style="float: right">
                        <button type="button" onclick="Requests();">Send</button>
                    </div>
            </div>
            </form>
          </div>

          <div class="contain">
            <p class="section-header">Registers</p>
            <div class="table-contain">
              <table id="dataTable">
                <thead>
                  <tr>
                    <th>Data type</th>
                    <th>Register</th>
                    <th>Data</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="column">
          <div class="contain">
            <p class="section-header">Bus Monitor</p>
            <div>
            </div>
            <div style="margin: 10px; width: 95%; padding: 3px;">
                <p class="table-header">Raw Data Received:</p>
                <button style="float: right" onclick="ClearTransData('rawData')">Clear</button></thead>
                </div>
            <div class="table-contain">

              <table id="rawData">
                  

                <tbody>
                </tbody>
              </table>
            </div>
    
            <hr />
            <div style="margin: 10px; width: 95%; padding: 3px;">
                <p class="table-header">Modbus requests/responses:</p>
                <button style="float: right">Clear</button>
            </div>
              <div class="table-contain">

                
                <table>
                  <thead>
                    <tr>
                      <th>I/O</th>
                      <th>Slave ID</th>
                      <th>Function code</th>
                      <th>Start address</th>
                      <th>Num coils</th>
                      <th>CRC</th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>
                </table>
              </div>
			  <div style="margin: 10px; width: 95%; padding: 3px;">
                <p class="table-header">Translated Data</p>
                <button style="float: right" onclick="ClearTransData('translatedData')">Clear</button>
            </div>
              <div class="table-contain">

                
                <table id="translatedData">
                  <thead>
                    <tr>
                      <th>Registers</th>
                      <th>Float Data</th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>
                </table>
              </div>
          </div>
        </div>
      </div>
    </div>
	<script>

/*if the user clicks anywhere outside the select box,
then close all select boxes:*/
document.addEventListener("click", closeAllSelect);

	</script>
  </body>

</html>


